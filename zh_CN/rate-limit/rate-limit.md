# 速率限制

EMQX 提供对接入速度、消息速度的限制，从入口处避免了系统过载，保证了系统的稳定和可预测的吞吐。

## 限制器类型

EMQX 目前支持以下几种类型的限制器:

| 类型             | 描述                        | 过载后行为            |
| :-------------- | :------------------------- | :----------------- |
| bytes_rate      | 每秒流入的消息的字节数大小       | 暂停接收客户端消息     |
| messages_rate   | 每秒流入的消息条数             | 暂停接收客户端消息     |
| max_conn_rate   | 每秒的连接数                  | 暂停接收新的连接       |

## 使用

### 为监听器设置速率限制

通过将类型直接添加到侦听器配置中，可以很容易地为监听器器设置限制器:


```bash
listeners.tcp.default {
  bind = "0.0.0.0:1883"
  ## 将此监听器的连接速率限制设置为每秒 1000
  max_conn_rate = "1000/s"
  ## 将连接到此监听器的每个客户端的每秒发送消息数限制设置为 1000
  messages_rate = "1000/s"
  ## 将连接到此监听器的每个客户端的每秒发送消息大小限制设置为 1000M
  bytes_rate = "1000MB/s"
}
```

### 为当前节点设置速率限制

可以通过将下面的内容加入 `emqx.conf` 中， 来为当前整个节点设置限制器:


```bash
limiter {
  ## 设置当前整个节点的连接速率
  max_conn_rate = "1000/s"
  ## 设置当前整个节点的每秒发送消息的数量
  messages_rate = "1000/s"
  ## 设置当前整个节点每秒发送消息的大小
  bytes_rate = "1000MB/s"
}
```

## 单位

### 时间单位

速率值中支持的时间单位可以是：

- **s** :: 秒
- **m** :: 分钟
- **h** :: 小时
- **d** :: 天

时间单位也可以是一个间隔值，例如 `1000/10s` 表示将限制设置为每 10 秒 1000。

### 尺寸单位

速率值中支持的字节数大小单位可以是：

- **KB** :: 千字节
- **MB** :: 兆字节
- **GB** :: 吉字节
